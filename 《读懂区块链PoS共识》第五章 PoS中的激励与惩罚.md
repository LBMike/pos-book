# 第五章 PoS中的激励与惩罚

为什么PoS系统当中需要激励？没有激励行不行？多少激励才足够？

区块链的定义来源比特币，比特币立志于成为一种无政府主义的电子货币，摆脱中心化集权的控制，并且给所有人带来自由。自始至终，比特币给广大人们带来的印象就是去中心化和自由，但是，社会发展到今天，我们已经习惯了这种中心化思想形成的社会结构。国家，公司，乃至家

庭，都是不同形态下的中心。当我们要把去中心化当成主流的时候，我们会发现，我们要付出的代价，其实不小。特别在我们享受比特币带来的去中心化思想时，往往我们忽略的是自由背后所带来的成本。

作为一个去中心化的社区，比特币需要人运行程序来维护，而且越多的人维护，系统越安全。以往中心化公司运行的成本，其实相当于均摊到了维护网络的每个人。那么这些人的成本谁来承担？难不成都是心甘情愿自掏腰包吗？

不太可能，所以比特币的分发成为了激励手段，以及比特币背后的自由思想所带来的憧憬，给所有维护的人们画了一个大饼，这个大饼带着自由之光，照亮了人们对于未来暴富的无限遐想。所以，我们看到的是，比特币实现了去中心化的自由，用了一种激励的手段解决人们前期所付出的成本，这个可能不对等，但是确实一种很好的价值背书。

那么我们就不难理解了，作为PoW后时代的PoS，自然同样需要激励来维护去中心化所带来的成本。但是由于PoW算力挖矿的方式，被PoS的权重挖矿方式所替代，意味着网络运行初期，就需要有足够的币来进行挖矿。同时，足够多的币才能像足够多的算力一样，更安全的保证去中心化的网络运行，那么PoS的激励不能像比特币一样，由剩余总量作为奖励，而是通过增发通胀作为激励了。

增发是PoS上最为常见的一种激励手段，常年保持一个比较合理的增发率，来激励矿工有足够多的动力维护网络。网络的初期发展特别重要，所以通常，线性改变的增发率会把初始值设置的足够大，以此来吸引更多的验证人。同时，这也作为吸引已存在代币参与到（Staking）网络中来验证区块的重要点子，不参加网络安全验证的代币会被增发的代币稀释，这就是著名的PoS稀释性通胀的概念。

而后，增发率/通胀率会成为一个变化值，至于是多少合适，没有人能准确得出来。现在世界里面的货币政策，通常是伴随是通胀和紧缩同时发生的，在合适的时间使用合适的货币政策，是目前我们所能认识到的。比特币给我们带来的紧缩手段，PoS带来的通胀手段，都是区块链世界里面的一组实验。所以很多PoS公有链并没有把通胀率定死，而是初期定值，然后定价权交由社区定夺。

以太坊ETH把通胀率定在了年3%，Tezos和EOS把通胀率都定在了5%左右，Rchain把通胀率定在了7%，Cosmos把通胀率定在了7%~22%。目前来看，2019年要上主网的项目中，通胀率初始值都在5%~10%，看来是业界普遍的认同。

倒不是说这个是最终的答案，或者说根本没有人知道答案，真实的世界里总是复杂的，所以，拍脑袋决定是也是一种好的办法，而只要有一个人拍了脑袋，后面跟着的人连脑袋都不要拍，跟着就好了。


## 1.1.激励

PoS上的激励机制从比特币衍生而来，比特币需要矿工维护网络的运行和去中心化，那么激励矿工参与网络是需要的，受利益驱使，人们会追逐矿工出块所带来的利润，比特币将铸币分发做成一种激励机制，使用固定总量，分发稀缺性来吸引大量矿工涌入，成为比特币网络维护的一员。

PoS共识网络也一样需要维护，但是PoS的激励和比特币的激励不一样，PoS是新增铸币（PoS的存量已经在初始分发时分发出去了，相当于一些PoW项目里面的预挖），比特币是存量铸币，所以PoS的通胀设计和比特币的存量分发设计有些许不同，造就了两种激励本质上的不一样。

PoS共识中，激励分为两个重要阶段

- 启动

- 去中心化

PoS网络启动之初的通胀设计，是PoS网络重中之重，为了防止初始Stake的不足，导致的攻击成本过低问题，初始的激励要足够大，吸引人们将代币进行Staking，否则，短程攻击可能会发生，交易激励可能会被篡改。一般情况下，启动主网时，开发团队会利用初始分发中留给自己的代币（一般是20%）先行Staking维护网络，同时禁止其他节点进入，在保证整个网络运行一段时间后（一般是小一个月），再开放给所有持币人。

而在网络顺利启动之后，去中心化又成为了一个重要的激励方向，为了防止大户更大的情况出现，很多项目会在奖励激励上做文章，比如单一节点的总量超过整体总量的1%时，超出部分将会的线性较少的奖励，或者不会获得奖励。比如有一个大户持币量1.2%，那么0.2%的量是获得不了奖励的。这样可以有效的控制PoS中的大户恒大的问题。

其次，很多PoS项目会致力于将节点出块，验证程序做得足够简单，依赖的设备随手可得，让持币人能简单的参与到项目Staking中来，也会使得项目更进一步的去中心化，而不会因为无技能，无设备而导致无法参与网络运行

PoS中的激励是通胀型的，通胀的比例作为参数被写到了创世区块中，作为可改参数，意味着社区有权利对通胀率进行修改，从而满足不同时代下的需求。区块链项目活的时间还不够长，所以这个数字目前还未曾被修改过。不同项目的通胀率会在一个范围内（2%~20%）浮动，初始值在5%~7%，或有线性减少或是线性增加的趋势，来保证合理性。


    1. 1.1.激励的具体行为

一般PoS公有链，为了维护网络不会暂停（Halt）或者是崩溃（Crash），会尽可能的激励出块人正确行为，同时会对不良行为给与惩罚。这和现实中正向引导，反向打击的逻辑是一样的。区块链的区块是按一定时间一个个接着形成并连在一起的，区块链的数据是保证正确并不能被修改的，所以我们可以看到一些具体被激励的行为，包括

- 出块（验证，打包交易）

- 签名（验证被打包的交易）

- 披露（披露用于生成出块人选举的随机数）

- 谴责（举报出块人不良行为）

- 在线（长期保持节点在线）

- 治理（参与链上治理行为）

所有的行为对于区块链的维护是有影响的，只要这些行为被正确执行，很大概率下，区块链会一直运行下去。当然，随着区块链的发展，更多新的技术会被带入到现有区块链中来，那么这些新的技术又会带来新的问题，导致区块链停止运行，甚至崩溃，届时新的解决办法又会被引入进来。

除了以上约束外，PoS中的激励中还存在着一些隐患，这些隐患可能还隐藏的比较深，目前没法对其做约束或者无法约束。

另外，POS激励有很多自己的问题，比如大户问题，选举造假问题等，同样，相对于比特币，PoS激励和比特币激励也有着相同的一些问题，如激励不足，激励单一。下面我来说一下几个和比特币相同的问题。


    1. 1.2.激励不足

稳定的网络依赖于稳定的矿工群体以及稳定的代币参与（Stake），两者都依赖于系统代币对法币稳定的汇率，或者是说有不断上涨预期，这样才能让整个激励得以继续。从2012年到现在，Peercoin，Nxt，Blackcoin等，我们看到了太多项目因为币价掉的太多，导致激励不足的情况出现了。这样会形成一个恶性循环，当系统对验证人的要求更高，验证人为此投入的成本越多的时候，我们发现，币价无法补足人们在其投入的资金，这使得网络的顺利维护有不好的预期。

在法币本位的今天，代币作为激励的方案是区块链主流，但却不是商业主流。当验证人成为一种专业的工种之后，辛勤工作却不能养家糊口的话，是比较讽刺的。2017年到启动的牛市，把很多人带入到了币本位的道路上，但是这些人很快就发现，币本位在短期内基本都是亏钱的，亏法币的，这点对于一个创业公司来说，太致命了。

所以，代币作为激励的手段，经常会出现激励不足的问题，如果在1~3年的时间里面，不能带来足够的激励的话，那么验证人很容易会离开这个网络。

    1. 1.3.激励单一

激励不足的另外一面就是激励太单一，代币激励是一方面，另外一个方面是验证人获得奖励的机会。目前，提供给验证人获得奖励的主要机会就是出块和验证（不同的链有别的一些细微的机会设置），这和该验证人持有的币量权重或者是接受委托的币量权重是息息相关的，导致的结果就是验证人如果币量权重不够高，那么他获得的奖励是很少的。

比如一个验证人持币量持币量只占据整个网络中代币的0.01%，那么他只能获得整个网络0.01%的出块和验证机会，别以为0.01%已经很少了，PoS系统中小于该总量的人大有人在，这和世界上，20%的人占据了世界总量80%的财富是一个道理。PoS代币中，估值往往是几十亿美元，0.01%就是几千万美元，有多少人能有几千万美金的？所以，占据总量0.000001%就很不错了，那这0.000001%对应出块奖励就很少了。

所以，我们可以看到，这已经天然的形成一定的门槛，这个门槛会因为激励的不足以及单一，使得币量少的验证人慢慢离开网络，最后只剩下头部的玩家，整个系统又变成了有钱人的天下，强者恒强。

这和我们在比特币上看到的矿池是境况是一样的。


    1. 1.4.无法解决的问题？

目前的各种尝试当中，没有一个方案可以完全解决此类问题，大都为尝试性的解决，但触动不了根基。本质上，无法解决的问题是贫富差距问题，任何事情一旦和钱挂钩，就无法摆脱别人已经比你有钱的事实，企图劫富济贫，那是武侠小说，不是现实世界。

中本聪愿景是让所有有电脑的人参与到比特币的挖矿中来，这本质上就把一部分没有能力购买电脑的人隔离开了，所以世界上无法做到完全的公平，在去中心化的世界里面，也一样。

但是，我仍然很喜欢看到区块链世界里面，为此付出的尝试。比如Cosmos的官方客户端会针对头部验证人做出警示提醒，或是消减平均的收益率，又比如Tezos里面的接受委托和抵押金息息相关，自己没有抵押金，则无法获得奖励。这些都是防止强者恒强的手段，虽然触发不到根基，但是有一定的作用。


## 1.2.惩罚

比特币里面对矿工是没有惩罚的，硬要说有惩罚，那就是矿工挖出来了孤块。孤块是比特币里面被抛弃的块，合法，工作量证明足够，只不过是因为广播速度或是计算问题等原因，并没有被大部分节点所接收到，而是被另外一个块替代了。挖出来的孤块是没有比特币奖励的，对应的矿工需要自己承担算力成本，所以竞争条件下，付出了算力却没得到奖励，也算是变相的一种&quot;惩罚&quot;。

而我在这里说的惩罚，是PoS中独有的惩罚机制，叫Slash，不同于PoW的&quot;惩罚&quot;。

PoS中的惩罚机制是用来惩罚PoS中矿工的不良行为的。具体的不良行为由不同的链自己决定，虽有不同，但大致都是一个原则，那就是保证系统稳定，任何尝试分叉，双签，和长期不在线的矿工，基本上都会被惩罚。当然，这里的惩罚不单单是和比特币一样的没有奖励，同时还会扣除出块人/验证人在系统里面交的抵押金，相当于是双重惩罚。

抵押金是PoS惩罚机制中独有的设计，抵押金的引入是解决PoS中多方面问题的一个综合解决方案。在PoS共识中，矿工由算法根据持币量权重选出，这些矿工在出块时，作恶的成本要比PoW小的多，因为可以无限制的出块，出多个块，签名分叉链等，不诚实的矿工会想尽办法作恶来获取更多的利益。

在没有抵押金的时代，这个动机显得十分充足，2012年~2014年的那些年代，矿工几乎可以随意的&quot;攻击&quot;这个网络，侥幸来欺骗系统来获得更多的奖励。PoW里面出块是有成本的，需要消耗算力，电力等，矿工好不容易获得了出块机会，如果尝试攻击系统，一旦被其他矿工识别出来，失去奖励的成本比作恶获得的奖励要大，所以这么做就得不偿失了。而PoS中，出块人的自由度是没有成本可言的，本质上就和PoW区分开了，这就是PoS里面著名的Nothing at Stake的问题（这个问题会在第九章节有具体描述）。

所以引入抵押金后，系统会对矿工行为进行检测，一旦发现检测不法行为，系统将会扣除矿工的抵押金。而矿工因为担心抵押金会被扣除，自然也不敢作恶了。


    1. 2.1.Slash

2014年1月，Vitalik Burtain首次提及了[S](https://blog.ethereum.org/2014/01/15/slasher-a-punitive-proof-of-stake-algorithm/)[la](https://blog.ethereum.org/2014/01/15/slasher-a-punitive-proof-of-stake-algorithm/)[s](https://blog.ethereum.org/2014/01/15/slasher-a-punitive-proof-of-stake-algorithm/)[her](https://blog.ethereum.org/2014/01/15/slasher-a-punitive-proof-of-stake-algorithm/)，后Slash这种手段被广泛应用于PoS共识当中，作为了PoS中解决网络安全的一个重要手段。Slasher可以被翻译为&quot;刽子手&quot;或者扣除人，Slash可以被翻译为削减（开支），或者意译为扣除抵押金。

当时的区块世界，PoW还是主流的共识，很多项目在开始往PoS共识转，但也是这时候PoS上一个重要的缺陷（Nothing at Stake）开始暴露出来，这种缺陷会导致链分叉，从而使得双花攻击成功的概率大大提高。

Vitalik提议用惩罚的手段将出块人的企图扼杀在摇篮当中，这种方法叫做Slasher。区块链对分叉或者重复提交行为进行检测，一旦检测出来，该行为就会被惩罚（Slash），而惩罚的抵押金意味着Nothing at Stake变成Something at Stake。

那么Somethin at Stake中的Something指的就是现在抵押金（bond，或者叫secure deposit）了，抵押金作为出块人出块的基础，诚实的出块人并不会害怕抵押金被扣除（Slash），因为他们不会去篡改程序，进行双花攻击，而不诚实的出块人因为抵押金可能会被扣除的可能性，动机减弱。

Slash的抵押金会被回收到系统中，不同系统对Slash的抵押金的处理不同，一般情况下，会全部销毁（burn），一些系统有举报人，如Tezos，Polkadot，这些系统Slash的抵押金会把少部分给举报人，大部分销毁。还有一种设计就是一部分销毁，一部分流入基金会的统一池子，用于后续的社区/项目资助。

但是，Vitalik并没有在2014年发表的博客中介绍Slasher具体的实现，也没有提到抵押金，只是阐述了一下Slash的方法论。后Slasher经过4年左右时间的发展，已经逐渐发展成为PoS共识当中一个重要的标配功能。


    1. 2.2.Slash的具体行为

现在我们知道了Slash的对象是出块人，Slash的结果是抵押金被扣除，奖励也无法获得。下面我来说一下Slash的具体行为。不同系统对于Slash的行为不同，Slash的多少也不相同。我列举了一下通用的会被Slash的行为，如

- 双块：指在同一个高度下，一个出块人出多个块

- 双签：指在同一个高度下，一个验证人验证了不同链上上的块；或者指在同一高度下，一个验证人在一条链上的同一个块，签多次名

有些项目还有把节点在线时间和投票情况作为可能会被Slash的行为，对于节点要求是比较严格的，比如Cosmos。

大体上，Slash的行为并不会很多，或者说不敢有太多，毕竟Slash还是新鲜事物，凡是有两面，Slash不好，过度，会对出块人生态造成伤害，特别是区块链项目并不成熟的情况下，发生误杀的话，很难处理。所以，我觉得把Slash用作为分叉杀手锏就可以了，其他的一些行为可以在区块链项目越来越成熟后再慢慢增加。


    1. 2.3.Slash多少？

那么抵押金交多少合适呢？扣除抵押金的时候扣除多少合理呢？这涉及到一个计算问题，有两种算法：

- 第一种：单块抵押，也就是只要是做涉及到奖励的行为的时候，就需要提前按比例交抵押金

- 第二种：整体抵押，也就是在做涉及奖励的行为之前，你的持币量是全部当成抵押金的。

在Slash发生的时候，第一种是扣除单个行为所交的所有抵押金，第二种是扣除全部抵押金的一部分，视情节严重程度来确定。

其实两种算法有相似之处，最终的Slash结果都是落在了抵押金的按比例扣除上。而实际中，两种算法对社区生态是有不同影响的。我们先说相似之处的抵押金情况，我们举个例子，有一条PoS公有链的参数如下：

-
  - 年通胀率 5%

-
  - 初始供应量 10亿

-
  - 区块时间间隔 10s

每个区块奖励=10亿\*5%/(365\*24\*60\*（60/10）\*10)=1.6

一个矿工持币量1亿，那么他需要交多少抵押金呢？我们再列几个系统参数

-
  - 抵押金赎回时间 15天

-
  - 单块抵押金为51.2

抵押的币量=(15\*24\*60\*（60/10）\*10)\*51，2=66355200

抵押率=66355200/10亿=6.6%

个人出1个块需要抵押金=1亿\*6.6%=6635520

_其中单块抵押金需要51.2个代币是按照Tezos的抵押算法算出来的，我并不知道为什么Tezos单个块的抵押金是512XTZ，我大概的猜想是为了算出接近8%个左右的安全抵押率。如果猜想正确的话，PoS抵押金我们认为会在整体持币量的8%左右。当然，Tezos也可能拍脑袋决定的。_

如果发生Slash，按照第一种抵押方式，该个人会被扣除6635520个代币，但是1亿里面其他的代币并不会受影响，可以继续进行出块。第二种抵押方式，1亿个代币都在抵押中，只不过在下一个机会获得之前，他的代币会被扣除6635520个。

激励和惩罚是PoS有别于PoW的另外两个点，个别链在设计上都独具匠心，这个我在第十章中会有具体的解释。